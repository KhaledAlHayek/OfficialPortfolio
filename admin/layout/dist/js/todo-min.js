let addToDoBox=document.querySelector(".new-todo .new"),closeToDoPopups=document.querySelectorAll(".todo-popup .box .close-box");closeToDoPopups.forEach(e=>{e.addEventListener("click",e=>{let t=e.currentTarget.dataset.target;if(""!=t){document.querySelector(`.${t}`).classList.add("hide-popup")}else{e.currentTarget.parentElement.parentNode.classList.add("hide-popup")}})}),addToDoBox.onclick=showAddBox;let formAddToDo=document.forms["add-todo"],formAddElements=Array.from(formAddToDo.children),tasksBox=document.querySelector(".todo-list .list-body .the-todo"),tasks=[];function showAddBox(){document.querySelector(".add-new-todo").classList.remove("hide-popup")}function removeAddBox(){document.querySelector(".add-new-todo").classList.add("hide-popup")}function add(e,t){const o={id:Date.now(),subject:e,content:t,completed:!1};tasks.push(o),addToLocalStorage(tasks),fill(tasks)}function addToLocalStorage(e){localStorage.setItem("tasks",JSON.stringify(e))}function get(){if(localStorage.getItem("tasks")){fill(JSON.parse(localStorage.getItem("tasks")))}}function fill(e){tasksBox.innerHTML="",e.forEach(e=>{let t=document.createElement("div");t.className="todo-box";let o=document.createElement("div");o.className="check";let d=document.createElement("div");d.className="todo-text";let c=document.createElement("input");c.setAttribute("type","checkbox"),c.setAttribute("id",`i${e.id}`),c.className="single-checkbox",o.appendChild(c);let s=document.createElement("label");s.className=e.completed?"act-as-header completed":"act-as-header",s.appendChild(document.createTextNode(e.subject)),s.setAttribute("for",`i${e.id}`);let a=document.createElement("label");a.setAttribute("for",`i${e.id}`),a.appendChild(document.createTextNode(e.content)),d.appendChild(s),d.appendChild(a),t.appendChild(o),t.appendChild(d),tasksBox.appendChild(t)})}function getTaskByID(e){return tasks.filter(t=>t.id==e)}function deleteTask(e){updateTodoBox(tasks=tasks.filter(t=>t.id!=e))}function finished(e){tasks.filter(t=>t.id==e)[0].completed=!0,updateTodoBox(tasks)}function notFinsihed(e){tasks.filter(t=>t.id==e)[0].completed=!1,updateTodoBox(tasks)}function finishedMultiple(...e){e.forEach(e=>{tasks.filter(t=>t.id==e).forEach(e=>{e.completed=!0}),updateTodoBox(tasks)})}function notFinsihedMultiple(...e){e.forEach(e=>{tasks.filter(t=>t.id==e).forEach(e=>{e.completed=!1}),updateTodoBox(tasks)})}function updateTodoBox(e){addToLocalStorage(e),tasksBox.innerHTML="",refresh(),fill(e)}function refresh(){location.href="todo.php"}localStorage.getItem("tasks")&&(tasks=JSON.parse(localStorage.getItem("tasks"))),get(),formAddToDo.addEventListener("submit",e=>{e.preventDefault();let t=formAddToDo.querySelector(".subject").value,o=formAddToDo.querySelector(".text").value;if(""==t&&formAddToDo.querySelector(".subject").focus(),""==o&&formAddToDo.querySelector(".text").focus(),""!=t&&""!=o){let e=document.querySelector(".loading");e.classList.add("show"),setTimeout(()=>{e.classList.remove("show")},3e3),removeAddBox(),add(t,o),refresh()}});let singleTaskCheckbox=document.querySelectorAll(".todo-list .list-body .the-todo input[type='checkbox']"),toDoActions=document.querySelector(".list-header .todo-action");function showActions(){toDoActions.classList.add("show-actions")}function hideActions(){toDoActions.classList.remove("show-actions")}document.addEventListener("change",e=>{if(e.target.classList.contains("check-all-inputs")){e.target.checked?(singleTaskCheckbox.forEach(e=>{e.setAttribute("checked","true")}),showActions()):(singleTaskCheckbox.forEach(e=>{e.removeAttribute("checked")}),hideActions())}});let completedAction=document.querySelector(".completed-todo"),notCompletedAction=document.querySelector(".not-completed"),counter=0;for(let e=0;e<singleTaskCheckbox.length;e++)singleTaskCheckbox[e].addEventListener("change",t=>{singleTaskCheckbox[e].checked?counter++:counter--;t.currentTarget.getAttribute("id").substring(1);let o=document.querySelector(".todo-action");console.log(counter),counter>0?(showActions(),o.addEventListener("click",e=>{let t=[];if(singleTaskCheckbox.forEach(e=>{e.checked&&t.push(e.getAttribute("id").substring(1))}),e.target.classList.contains("completed-todo")){for(let e of t){tasks.filter(t=>t.id==e)[0].completed=!0}updateTodoBox(tasks)}if(e.target.classList.contains("not-completed")){for(let e of t){tasks.filter(t=>t.id==e)[0].completed=!1}updateTodoBox(tasks)}if(e.target.classList.contains("delete-todo")){for(let e of t)tasks=tasks.filter(t=>t.id!=e);updateTodoBox(tasks)}e.target.classList.contains("edit-todo")})):hideActions()});let checkAll=document.querySelector(".list-body .check-all-inputs");function markAllAsCompleted(){singleTaskCheckbox.forEach(e=>{if(e.checked){let t=[],o=e.getAttribute("id");t.push(o.substring(1)),finishedMultiple(t)}})}checkAll.addEventListener("change",e=>{let t=checkAll.parentElement.nextElementSibling;checkAll.checked?(t.style.display="block",t.addEventListener("click",markAllAsCompleted)):t.style.display="none"});let toDoEditPopup=document.querySelectorAll(".todo-popup .new-box form .edit-box");toDoEditPopup.forEach(e=>{e.addEventListener("click",e=>{toDoEditPopup.forEach(e=>{e.classList.remove("current-expanded"),e.classList.remove("active-one")}),e.currentTarget.classList.toggle("active-one"),e.currentTarget.classList.contains("active-one")?e.currentTarget.classList.add("current-expanded"):e.currentTarget.classList.remove("current-expanded")})});let editToDoButton=document.querySelector(".edit-todo"),toDoEditBox=document.querySelector(".edit-todo-box"),formSubmitEdit=document.forms["submit-multiples"];function generateEditForms(e){let t=e.length;for(let o=0;o<t;o++){let t=document.createElement("div");t.className="edit-box";let d=document.createElement("div");d.className="edit-head";let c=document.createElement("div");c.className="title";let s=document.createElement("h3");s.appendChild(document.createTextNode("Subject")),c.appendChild(s);let a=document.createElement("div");a.className="arrow";let l=document.createElement("i");l.className="fas fa-arrow-down",a.appendChild(l),d.appendChild(c),d.appendChild(a);let n=document.createElement("div");n.className="edit-body";let i=document.createElement("div");i.className="input";let r=document.createElement("label");r.setAttribute("for",`subject-${e[o]}`),r.appendChild(document.createTextNode("Subject"));let u=document.createElement("div");u.className="input";let m=document.createElement("label");m.setAttribute("for",`subject-${e[o]}`),m.appendChild(document.createTextNode("Subject")),n.appendChild(i),n.appendChild(u),t.appendChild(d),t.appendChild(n),formSubmitEdit.prepend(t)}}editToDoButton.addEventListener("click",()=>{toDoEditBox.classList.remove("hide-popup");let e=[];singleTaskCheckbox.forEach(t=>{if(t.checked){let o=t.getAttribute("id").substring(1);e.push(o)}}),generateEditForms(e)});